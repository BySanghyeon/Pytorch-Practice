{"cells":[{"cell_type":"markdown","metadata":{"id":"P6EDkmEl-E3M"},"source":["# Character Level RNN\n","\n","> 들여쓴 블록"]},{"cell_type":"markdown","metadata":{"id":"FFMhD1dG-E3V"},"source":["이번 포스트에선 단어를 분류하기 위해 기초적인 문자-단위 RNN을 구축하고 학습할 것이다.\n","문자-단위 RNN은 단어를 문자의 연속으로 읽어 각 단계의 예측과 hidden state를 출력하고 다음 단계에 은닉 상태를 전달한다. \n","단어가 속한 클래스로 출력이 되도록 최종 예측을 선택한다. \n","\n","이번 포스트의 목적은 18 개의 언어로 된 수천개의 성(surname)을 훈련 시키고 철자에 따라 어떤언어인지 예측 하는것이다.\n"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lexHDwFm-kzg","executionInfo":{"status":"ok","timestamp":1645597868123,"user_tz":-540,"elapsed":29575,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"5d5ae78f-56d5-4ffe-dbfb-5b66f55340a9"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["pwd"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"Xnm4CbI9_bF0","executionInfo":{"status":"ok","timestamp":1645597868124,"user_tz":-540,"elapsed":13,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"153a9a79-642b-4dc4-a395-f4789e6520e5"},"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'/content'"]},"metadata":{},"execution_count":2}]},{"cell_type":"markdown","metadata":{"id":"whdLQNMK-E3X"},"source":["## 데이터 준비\n"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2yZkvVCv-E3Z","executionInfo":{"status":"ok","timestamp":1645597872457,"user_tz":-540,"elapsed":4342,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"752763a3-ac48-4eab-e4ee-8740f69f12d8"},"outputs":[{"output_type":"stream","name":"stdout","text":["['drive/MyDrive/Colab Notebooks/names/Polish.txt', 'drive/MyDrive/Colab Notebooks/names/Russian.txt', 'drive/MyDrive/Colab Notebooks/names/Dutch.txt', 'drive/MyDrive/Colab Notebooks/names/Czech.txt', 'drive/MyDrive/Colab Notebooks/names/Spanish.txt', 'drive/MyDrive/Colab Notebooks/names/Scottish.txt', 'drive/MyDrive/Colab Notebooks/names/Greek.txt', 'drive/MyDrive/Colab Notebooks/names/Arabic.txt', 'drive/MyDrive/Colab Notebooks/names/Portuguese.txt', 'drive/MyDrive/Colab Notebooks/names/French.txt', 'drive/MyDrive/Colab Notebooks/names/Italian.txt', 'drive/MyDrive/Colab Notebooks/names/Irish.txt', 'drive/MyDrive/Colab Notebooks/names/German.txt', 'drive/MyDrive/Colab Notebooks/names/Japanese.txt', 'drive/MyDrive/Colab Notebooks/names/Korean.txt', 'drive/MyDrive/Colab Notebooks/names/English.txt', 'drive/MyDrive/Colab Notebooks/names/Chinese.txt', 'drive/MyDrive/Colab Notebooks/names/Vietnamese.txt']\n","Slusarski\n"]}],"source":["from __future__ import unicode_literals, print_function, division\n","from io import open\n","import glob\n","import os\n","\n","def findFiles(path): return glob.glob(path)\n","\n","print(findFiles('drive/MyDrive/Colab Notebooks/names/*.txt'))\n","\n","import unicodedata\n","import string\n","\n","all_letters = string.ascii_letters + \" .,;''\"\n","n_letters = len(all_letters)\n","\n","# 유니코드 문자열을 ASCII로 변환 , https://stackoverflow.com/a/518232/2809427 참고\n","def unicodeToAscii(s):\n","    return ''.join(\n","        c for c in unicodedata.normalize('NFD', s)\n","        if unicodedata.category(c) != 'Mn'\n","        and c in all_letters\n","    )\n","\n","print(unicodeToAscii('Ślusàrski'))\n","\n","# 각 언어의 이름 목록인 category_lines 사전생성\n","category_lines = {}\n","all_categories = []\n","\n","# 파일을 읽거 줄 단위로 분리\n","def readLines(filename):\n","    lines = open(filename, encoding='utf-8').read().strip().split('\\n')\n","    return [unicodeToAscii(line) for line in lines]\n","\n","for filename in findFiles('drive/MyDrive/Colab Notebooks/names/*.txt'):\n","    category = os.path.splitext(os.path.basename(filename))[0]\n","    all_categories.append(category)\n","    lines = readLines(filename)\n","    category_lines[category] = lines\n","\n","n_categories = len(all_categories)"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Oi3b-s4S-E3g","executionInfo":{"status":"ok","timestamp":1645597872458,"user_tz":-540,"elapsed":24,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"9d43569f-f2d8-4589-dad2-b8eaa39b7fc8"},"outputs":[{"output_type":"stream","name":"stdout","text":["['Abandonato', 'Abatangelo', 'Abatantuono', 'Abate', 'Abategiovanni']\n"]}],"source":["print(category_lines['Italian'][:5])"]},{"cell_type":"markdown","metadata":{"id":"XFa3qI0j-E3i"},"source":["## 이름을 Tensor로 변경 "]},{"cell_type":"markdown","metadata":{"id":"LDF5aDVx-E3k"},"source":["하나의 문자를 표현하기 위해 크기가 <1 x n_letters>인 one-hot vector를 사용한다. \n","단어를 만들기 위해 벡터들을 <line_length x 1 x n_letters>에 결합한다. 여기서 1은 배치가 있다고 가정하기 때문이다."]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-s2zJ6nF-E3n","executionInfo":{"status":"ok","timestamp":1645597878202,"user_tz":-540,"elapsed":5764,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"7566b8f5-fc83-4dc1-95c6-4472237b1941"},"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,\n","         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","         0., 0., 0., 0.]])\n","torch.Size([5, 1, 58])\n"]}],"source":["import torch \n","\n","# all_letters로 문자의 주소 찾기, 예시 \"a\" = 0\n","def letterToIndex(letter):\n","    return all_letters.find(letter)\n","\n","# 검증을 위행 한개의 문자를 <1 x n_letters> 로 변환 \n","def letterToTensor(letter):\n","    tensor = torch.zeros(1, n_letters)\n","    tensor[0][letterToIndex(letter)] = 1\n","    return tensor\n","\n","# 한줄을 <line_length x 1 x n_letters> 또는 One_Hot 문자 벡터의 Array로 변경 \n","def lineToTensor(line):\n","    tensor = torch.zeros(len(line), 1, n_letters)\n","    for li, letter in enumerate (line):\n","        tensor[li][0][letterToIndex(letter)] = 1\n","    return tensor\n","\n","print(letterToTensor('J'))\n","print(lineToTensor('Jones').size())"]},{"cell_type":"markdown","metadata":{"id":"4kvLo0IM-E3p"},"source":["## 네트워크 생성\n","\n","Autograd 전에, Torch에서 RNN생성은 여러 시간 단계에 걸쳐서 계층의 매개변수를 복제하는 작업을 포함한다. \n","계층은 hidden state와 gradient를 가지며, 이것들은 그래프 자체에서 완전히 처리된다. \n","이는 feed-forward 계층과 같은 매우 순수한 방법으로 RNN구현할 수 있다는것을 의미한다. \n","\n","![image.png](attachment:90ab0c4b-89a2-4402-870e-961e7a97964f.png)"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"2v2eZMna-E3r","executionInfo":{"status":"ok","timestamp":1645597878203,"user_tz":-540,"elapsed":38,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}}},"outputs":[],"source":["import torch.nn as nn\n","\n","class RNN(nn.Module):\n","    def __init__(self, input_size, hidden_size, output_size):\n","        super(RNN, self).__init__()\n","        \n","        self.hidden_size = hidden_size\n","        \n","        self.i2h = nn.Linear(input_size + hidden_size, hidden_size)\n","        self.i2o = nn.Linear(input_size + hidden_size, output_size)\n","        self.softmax = nn.LogSoftmax(dim=1)\n","        \n","    def forward(self, input, hidden):\n","        combined = torch.cat((input, hidden), 1)\n","        hidden = self.i2h(combined)\n","        output = self.i2o(combined)\n","        output = self.softmax(output)\n","        return output, hidden\n","\n","    def initHidden(self):\n","        return torch.zeros(1, self.hidden_size)\n","\n","n_hidden = 128\n","rnn = RNN(n_letters, n_hidden, n_categories)\n","        "]},{"cell_type":"markdown","metadata":{"id":"wfZDfEuU-E3u"},"source":["이 네트워크의 한단계를 실행하려면 입력인 현재문자 tensor와 이전의 hidden state를 전달해야 한다. 출력값인 각 언어의 확률과 다음 hidden state를 반환 받는다. "]},{"cell_type":"code","execution_count":7,"metadata":{"id":"A3I_vw3E-E3v","executionInfo":{"status":"ok","timestamp":1645597878204,"user_tz":-540,"elapsed":37,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}}},"outputs":[],"source":["input = letterToTensor('A')\n","hidden = torch.zeros(1, n_hidden)\n","\n","output, next_hidden = rnn(input, hidden)"]},{"cell_type":"markdown","metadata":{"id":"JOnqDktd-E3x"},"source":["매 단계마다 새로운 tensor를 만드는것은 효율성을 저해한다. 그래서 letterToTensor 대신 lineToTensor를 잘라서 사용할 것이다. 이는 Tensor의 pre-computing 배치에 의해 더욱 최적화 할수 있다."]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SUJOxNIq-E3y","executionInfo":{"status":"ok","timestamp":1645597878204,"user_tz":-540,"elapsed":36,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"1b43a29d-0776-4c8e-eee1-9a6f28cc9c33"},"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[-2.7902, -2.8721, -2.9658, -2.9280, -2.9359, -2.8586, -2.8691, -2.9751,\n","         -2.8902, -2.9007, -2.9404, -2.9626, -2.9080, -2.7766, -2.8545, -2.8555,\n","         -2.8634, -2.9064]], grad_fn=<LogSoftmaxBackward0>)\n"]}],"source":["input = lineToTensor('Albert')\n","hidden = torch.zeros(1, n_hidden)\n","\n","output, next_hidden = rnn(input[0], hidden)\n","print(output)\n"]},{"cell_type":"markdown","metadata":{"id":"rkfdwa8n-E3z"},"source":["출력은 <1x n_categories> tensor이고, 모든 항목은 해당 카테고리의 likelihood이다."]},{"cell_type":"markdown","metadata":{"id":"2IvVH-X4-E30"},"source":["## 학습 "]},{"cell_type":"markdown","metadata":{"id":"P21isF1O-E31"},"source":["### 학습 준비\n","\n","네트워크 출력으로 가장 높은 카테고리 이름과 카테고리 변호 반환"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9GCVAlBa-E31","executionInfo":{"status":"ok","timestamp":1645597878205,"user_tz":-540,"elapsed":33,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"35f026d5-1f9b-4e71-c280-9c1db52201f8"},"outputs":[{"output_type":"stream","name":"stdout","text":["('Japanese', 13)\n"]}],"source":["def categoryFromOutput(output):\n","    top_n, top_i = output.topk(1) # 텐서의 가장 큰 값 및 주소\n","    category_i = top_i[0].item() # 텐서에서 정수 값으로 변경\n","    return all_categories[category_i], category_i\n","\n","print(categoryFromOutput(output))"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6Hpzil-B-E32","executionInfo":{"status":"ok","timestamp":1645597878206,"user_tz":-540,"elapsed":30,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"11f146d8-3b7a-4848-f65f-700867165508"},"outputs":[{"output_type":"stream","name":"stdout","text":["category = Arabic / line = Naifeh\n","category = Italian / line = Spano\n","category = Vietnamese / line = Mai\n","category = Dutch / line = Oomen\n","category = Czech / line = Coma\n","category = Polish / line = Pasternack\n","category = Scottish / line = Crawford\n","category = French / line = Paternoster\n","category = Scottish / line = Henderson\n","category = Russian / line = Viranovsky\n"]}],"source":["import random\n","\n","def randomChoice(l):\n","    return l[random.randint(0, len(l) - 1)]\n","\n","def randomTrainingExample():\n","    category = randomChoice(all_categories)\n","    line = randomChoice(category_lines[category])\n","    category_tensor = torch.tensor([all_categories.index(category)], dtype=torch.long)\n","    line_tensor = lineToTensor(line)\n","    return category, line, category_tensor, line_tensor\n","\n","for i in range(10):\n","    category, line, category_tensor, line_tensor = randomTrainingExample()\n","    print('category =', category, '/ line =', line)"]},{"cell_type":"markdown","metadata":{"id":"98NQ_yph-E33"},"source":["### 네트워크 학습\n","\n","이 네트워크를 학습하는데 필요한 학습데이터를 보여주고 추정한다. 만일 추정이 틀릴시 알려준다.\n","RNN의 마지막 계층이 nn.LogSoftmax이므로 손실 함수로 nn.NLLLoss각 적합하다."]},{"cell_type":"code","execution_count":11,"metadata":{"id":"kPxANM3W-E34","executionInfo":{"status":"ok","timestamp":1645597878206,"user_tz":-540,"elapsed":26,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}}},"outputs":[],"source":["criterion = nn.NLLLoss()"]},{"cell_type":"markdown","metadata":{"id":"72gB3s3n-E34"},"source":["각 학습의 루프는 다음과 같다.\n","\n","- 입력과 목표 tensor 생성\n","- 0으로 초기화된 은닉 상태 생성\n","- 각 문자를 읽기 -> 다음 문자를 위한 은닉상태 유지\n","- 목표와 최종 출력 비교\n","- 역전파 \n","- 출력과 손실 반환"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"Tb89S4YQ-E35","executionInfo":{"status":"ok","timestamp":1645597878207,"user_tz":-540,"elapsed":27,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}}},"outputs":[],"source":["learning_rate = 0.005\n","\n","def train(category_tensor, line_tensor):\n","    hidden = rnn.initHidden()\n","    \n","    rnn.zero_grad()\n","    \n","    for i in range(line_tensor.size()[0]):\n","        output, hidden = rnn(line_tensor[i], hidden)\n","        \n","    loss = criterion(output, category_tensor)\n","    loss.backward()\n","    \n","    for p in rnn.parameters():\n","        p.data.add_(p.grad.data, alpha= -learning_rate)\n","        \n","    return output, loss.item()"]},{"cell_type":"markdown","metadata":{"id":"BPrMFxR_-E36"},"source":["train 함수가 출력과 손실을 반환하기 때문에 추정값을 화면에 출력하고 도식화를 위한 손실을 추척할 수 있다."]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WWa2hAv2-E36","executionInfo":{"status":"ok","timestamp":1645598005085,"user_tz":-540,"elapsed":126528,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"f94d6dee-d82a-41ed-e049-798ba7599cb8"},"outputs":[{"output_type":"stream","name":"stdout","text":["5000 5% (0m 6s) 2.8966 Nader / German ✗ (Arabic)\n","10000 10% (0m 13s) 3.0760 Taidhg / Arabic ✗ (Irish)\n","15000 15% (0m 20s) 1.7664 Lebedevich / Russian ✓\n","20000 20% (0m 26s) 1.7205 Zeni / Chinese ✗ (Italian)\n","25000 25% (0m 32s) 0.9131 Dritsas / Greek ✓\n","30000 30% (0m 38s) 0.4231 Thach / Vietnamese ✓\n","35000 35% (0m 45s) 1.2740 Halabi / Arabic ✓\n","40000 40% (0m 51s) 0.7555 Czajka / Polish ✓\n","45000 45% (0m 57s) 0.6949 Dao / Vietnamese ✓\n","50000 50% (1m 3s) 1.4986 Prinz / German ✓\n","55000 55% (1m 10s) 0.4691 Sitko / Polish ✓\n","60000 60% (1m 16s) 0.6570 Hew / Chinese ✓\n","65000 65% (1m 23s) 2.8631 Kreisinger / German ✗ (Czech)\n","70000 70% (1m 29s) 1.9737 Favero / Portuguese ✗ (Italian)\n","75000 75% (1m 35s) 0.4215 Watson / Scottish ✓\n","80000 80% (1m 41s) 0.6944 Qin / Chinese ✓\n","85000 85% (1m 48s) 1.4332 Yin / Korean ✗ (Chinese)\n","90000 90% (1m 54s) 0.0195 Yoshizawa / Japanese ✓\n","95000 95% (2m 0s) 2.4986 Peij / Chinese ✗ (Dutch)\n","100000 100% (2m 6s) 1.9353 Jordan / English ✗ (Polish)\n"]}],"source":["import time \n","import math\n","\n","n_iters = 100000\n","print_every = 5000\n","plot_every = 1000\n","\n","# 도식화를 위한 손실 추적\n","current_loss = 0\n","all_losses = []\n","\n","def timeSince(since):\n","    now = time.time()\n","    s = now - since\n","    m = math.floor(s/60)\n","    s -= m * 60\n","    return '%dm %ds' % (m, s)\n","\n","start = time.time()\n","\n","for iter in range(1, n_iters + 1):\n","    category, line, category_tensor, line_tensor = randomTrainingExample()\n","    output, loss = train(category_tensor, line_tensor)\n","    current_loss += loss\n","    \n","    # iter 숫자, 손실, 이름, 추측화면 출력\n","    if iter % print_every ==0:\n","        guess, guess_i = categoryFromOutput(output)\n","        correct = '✓' if guess == category else '✗ (%s)' % category\n","        print('%d %d%% (%s) %.4f %s / %s %s' % (iter, iter / n_iters * 100, timeSince(start), \n","                                                loss,line, guess, correct))\n","        \n","        if iter % plot_every == 0:\n","            all_losses.append(current_loss / plot_every)\n","            current_loss = 0\n","\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"914U55yH-E37"},"source":["## 결과 도식화"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":283},"id":"s2jM6eIJ-E38","executionInfo":{"status":"ok","timestamp":1645598005086,"user_tz":-540,"elapsed":32,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"5dfda22f-05fc-4ac0-d705-ef96aa7d15a6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[<matplotlib.lines.Line2D at 0x7ffa9f51b790>]"]},"metadata":{},"execution_count":14},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["import matplotlib.pyplot as plt\n","import matplotlib.ticker as ticker\n","\n","plt.figure()\n","plt.plot(all_losses)"]},{"cell_type":"markdown","metadata":{"id":"f2zDR5Zh-E38"},"source":["## 결과평가"]},{"cell_type":"markdown","metadata":{"id":"x8gIZFGL-E38"},"source":["네트워크가 다른 카테고리에서 얼마나 잘 작동하는지 보기위해 모든 실제 언어가 네트워크에서 어떤 언어로 추측되는지를 나타내는 confusion matrix를 만든다. \n","이를 계산하기 위해 evaluate()로 많은 수의 샘플을 네트워크에 실행한다. evaluate()는 train()과 역전파를 뺴면 동일하다."]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":320},"id":"SxHtUfjj-E39","executionInfo":{"status":"ok","timestamp":1645598012651,"user_tz":-540,"elapsed":7229,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"bd1a94ac-1bd8-42c4-a4bf-f8cd2cec8bc9"},"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["confusion = torch.zeros(n_categories, n_categories)\n","n_confusion = 10000\n","\n","def evaluate(line_tensor):\n","    hidden = rnn.initHidden()\n","    \n","    for i in range(line_tensor.size()[0]):\n","        output, hidden = rnn(line_tensor[i], hidden)\n","        \n","    return output\n","\n","# 예시들 중에 어떤것이 정확하게 예측되었는지 기록\n","for i in range(n_confusion):\n","    category, line, category_tensor, line_tensor = randomTrainingExample()\n","    output = evaluate(line_tensor)\n","    guess, guess_i = categoryFromOutput(output)\n","    category_i = all_categories.index(category)\n","    confusion[category_i][guess_i] += 1\n","    \n","# 모든 행을 합계로 나누어 정규화\n","for i in range(n_categories):\n","    confusion[i] = confusion[i] / confusion[i].sum()\n","    \n","# 도식 설정\n","fig = plt.figure()\n","ax = fig.add_subplot(111)\n","cax = ax.matshow(confusion.numpy())\n","fig.colorbar(cax)\n","\n","# 축 설정 \n","ax.set_xticklabels([''] + all_categories, rotation=90)\n","ax.set_yticklabels([''] + all_categories)\n","\n","# 모든 tick에서 레이블 지정 \n","ax.xaxis.set_major_locator(ticker.MultipleLocator(1))\n","ax.yaxis.set_major_locator(ticker.MultipleLocator(1))\n","\n","plt.show()    "]},{"cell_type":"markdown","source":["### 사용자 입력으로 실행"],"metadata":{"id":"gs44PrvZP4Tt"}},{"cell_type":"code","source":["def predict(input_line, n_predictions=3):\n","    print('\\n>%s' % input_line)\n","    with torch.no_grad():\n","        output = evaluate(lineToTensor(input_line))\n","\n","        # get top N categories\n","        topv, topi = output.topk(n_predictions, 1, True)\n","        predictions = []\n","\n","        for i in range(n_predictions):\n","            value = topv[0][i].item()\n","            category_index = topi[0][i].item()\n","            print('(%.2f) %s' % (value, all_categories[category_index]))\n","            predictions.append([value, all_categories[category_index]])\n","\n","predict('Dovesky')\n","predict('Jackson')\n","predict('Satoshi')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3JzancQvFLtc","executionInfo":{"status":"ok","timestamp":1645598012652,"user_tz":-540,"elapsed":15,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}},"outputId":"2522316e-7120-4d0d-ff2d-1f28b8db3822"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["\n",">Dovesky\n","(-0.22) Russian\n","(-2.05) Czech\n","(-3.56) Polish\n","\n",">Jackson\n","(-0.75) Scottish\n","(-1.70) Russian\n","(-2.03) Greek\n","\n",">Satoshi\n","(-1.02) Italian\n","(-2.04) Japanese\n","(-2.40) Polish\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"wmZxo8RpRat-","executionInfo":{"status":"ok","timestamp":1645598012653,"user_tz":-540,"elapsed":13,"user":{"displayName":"Cho Sanghyeon","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"03618492692203589805"}}},"execution_count":16,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"},"colab":{"name":"Character Level RNN .ipynb의 사본","provenance":[{"file_id":"1anVi2PTzmJLqmwvf33xIsZdaqxmvNz15","timestamp":1645598104071}]},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}